<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>claude-agent-integration — Thrum</title>
  <meta name="description" content="">
  <!-- Open Graph -->
  <meta property="og:type" content="article">
  <meta property="og:title" content="claude-agent-integration — Thrum">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://leonletto.github.io/thrum/docs/claude-agent-integration.html">
  <meta property="og:site_name" content="Thrum">
  <meta property="og:image" content="https://leonletto.github.io/thrum/img/social-card.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="claude-agent-integration — Thrum">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="https://leonletto.github.io/thrum/img/social-card.png">
  <!-- Canonical: SPA is the primary URL -->
  <link rel="canonical" href="https://leonletto.github.io/thrum/docs.html#claude-agent-integration.html">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>&#x26A1;</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/theme.css">
  <link rel="stylesheet" href="../css/docs.css">
  <script>
    (function(){var t=localStorage.getItem('thrum-theme');if(t){document.documentElement.setAttribute('data-theme',t)}else if(window.matchMedia&&window.matchMedia('(prefers-color-scheme:light)').matches){document.documentElement.setAttribute('data-theme','light')}else{document.documentElement.setAttribute('data-theme','dark')}})();
  </script>
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <nav class="header-nav">
        <a href="../index.html" class="logo">
          <span class="logo-glyph">&gt;_</span>
          <span class="logo-text">thrum</span>
        </a>
        <div class="nav-links">
          <a href="../index.html" class="nav-link">Home</a>
          <a href="../docs.html" class="nav-link nav-link-active">Docs</a>
          <a href="../about.html" class="nav-link">About</a>
          <a href="https://github.com/leonletto/thrum" class="nav-link nav-link-external" target="_blank" rel="noopener">GitHub</a>
        </div>
      </nav>
    </div>
  </header>
  <main class="docs-content" style="max-width:48rem;margin:2rem auto;padding:0 1.5rem">
    <div class="docs-content-inner">
<h1>Claude Code Agent Integration</h1>
<p>Thrum ships two Claude Code agent definitions for multi-agent coordination.<br>Place these in <code>.claude/agents/</code> in any project that uses Thrum.</p>
<h2>thrum-agent</h2>
<p>A comprehensive coordination guide that teaches Claude Code how to use Thrum<br>for multi-agent workflows. Covers:</p>
<ul>
<li>MCP server integration and configuration</li>
<li>CLI commands for messaging, sessions, and coordination</li>
<li>Message listener pattern for async notifications</li>
<li>Priority handling (critical/high/normal/low)</li>
<li>Common workflows: task assignment, peer collaboration, code review</li>
<li>Beads integration for combined task + messaging coordination</li>
<li>Troubleshooting guide</li>
</ul>
<p><strong>Usage:</strong> Reference this agent when an AI agent needs to coordinate with other<br>agents via Thrum messaging.</p>
<details>
<summary>thrum-agent.md</summary>

<pre><code class="language-markdown hljs">---
name: thrum-agent
description: &gt;
  Thrum multi-agent coordination guide. Git-backed messaging for AI agents to
  communicate across sessions, worktrees, and machines. Covers MCP server
<span class="hljs-section">  integration, message-listener pattern, CLI usage, and Beads integration.
---</span>

<span class="hljs-section"># Thrum - Multi-Agent Coordination via Git</span>

<span class="hljs-section">## Overview</span>

Thrum is a Git-backed messaging system that enables AI agents and humans to
communicate persistently across sessions, worktrees, and machines. It uses Git
as the synchronization layer, ensuring all messages survive context window
limits, session restarts, and machine boundaries.

<span class="hljs-section">## Quick Start</span>

<span class="hljs-section">### 1. Register and Start Session</span>

thrum quickstart --name <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">your-name</span>&gt;</span></span> --role <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">role</span>&gt;</span></span> --module <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span></span> --intent &quot;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span></span>&quot;

Common roles: planner, implementer, reviewer, tester, coordinator

<span class="hljs-section">### 2. Configure MCP Server (recommended)</span>

Add to .claude/settings.json:

{
  &quot;mcpServers&quot;: {
<span class="hljs-code">    &quot;thrum&quot;: {
      &quot;type&quot;: &quot;stdio&quot;,
      &quot;command&quot;: &quot;thrum&quot;,
      &quot;args&quot;: [&quot;mcp&quot;, &quot;serve&quot;]
    }
  }
}
</span>
<span class="hljs-section">### 3. Launch Background Listener</span>

Spawn a message-listener sub-agent to get async notifications. Re-arm it every
time it returns (both MESSAGES<span class="hljs-emphasis">_RECEIVED and NO_</span>MESSAGES<span class="hljs-emphasis">_TIMEOUT).

### 4. Communicate

thrum send &quot;message&quot; --to @name       # Direct message
thrum send &quot;message&quot; --broadcast      # Broadcast to all
thrum inbox --unread                  # Check for new messages
thrum reply <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">msg-id</span>&gt;</span></span> &quot;response&quot;       # Reply (creates thread)

## MCP Tools

- send_</span>message — Send to specific agent via @name
<span class="hljs-bullet">-</span> check<span class="hljs-emphasis">_messages — Poll inbox, auto-mark read
- wait_</span>for<span class="hljs-emphasis">_message — Block until message arrives
- list_</span>agents — Show registered agents
<span class="hljs-bullet">-</span> broadcast<span class="hljs-emphasis">_message — Send to all agents

## Priority Handling

| Priority | Action |
|----------|--------|
| critical | Stop current work immediately |
| high | Process at next breakpoint |
| normal | Process when current sub-task completes |
| low | Queue, process when convenient |

## Session Template

# Start
thrum quickstart --name <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span></span> --role <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">role</span>&gt;</span></span> --module <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span></span> --intent &quot;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">desc</span>&gt;</span></span>&quot;
thrum inbox --unread

# During work
thrum send &quot;status update&quot; --to @coordinator

# End
thrum session end</span></code></pre>
</details>

<h2>message-listener</h2>
<p>A lightweight background agent (runs on Haiku for ~$0.00003/cycle) that polls<br>for incoming messages. It loops inbox checks with 30-second sleep intervals for<br>up to ~5 minutes, returning immediately when new messages arrive.</p>
<p><strong>Usage:</strong> Spawn at the start of every coordination session. Re-arm immediately<br>when it returns.</p>
<details>
<summary>message-listener.md</summary>

<pre><code class="language-markdown hljs">---
name: message-listener
description: &gt;
  Background listener for incoming Thrum messages. Runs on Haiku for cost
  efficiency (~$0.00003/cycle). Loops inbox checks with sleep intervals for up
  to ~5 minutes, returning immediately when new messages arrive.
model: haiku
allowed-tools:
<span class="hljs-section">  - Bash
---</span>

You are a background message listener for the Thrum agent messaging system.

<span class="hljs-section">## CRITICAL: Tool Constraints</span>

You do NOT have access to MCP tools. You MUST use the Bash tool exclusively to
run thrum CLI commands.

<span class="hljs-section">## Instructions</span>

You run a polling loop: check inbox, sleep, repeat. Return immediately when you
find messages from other agents. Otherwise loop until your budget is exhausted.

Your prompt contains the EXACT command to use after &quot;INBOX<span class="hljs-emphasis">_CMD=&quot;. Use that
command verbatim.

<span class="hljs-strong">**LOOP**</span> (repeat up to 10 cycles):

1. Check inbox (Bash): Run the INBOX_</span>CMD from your prompt EXACTLY as given.
<span class="hljs-bullet">2.</span> If messages found, return them immediately.
<span class="hljs-bullet">3.</span> If no messages, sleep 30 seconds.
<span class="hljs-bullet">4.</span> Go back to step 1.

After exhausting all cycles with no messages, return NO<span class="hljs-emphasis">_MESSAGES_</span>TIMEOUT.

<span class="hljs-section">## Return Format</span>

When messages received:

<span class="hljs-section">MESSAGES<span class="hljs-emphasis">_RECEIVED
---
FROM: [sender]
PRIORITY: [priority]
CONTENT: [message content]
---

When timeout:

NO_</span>MESSAGES<span class="hljs-emphasis">_TIMEOUT

Always end with:

RE-ARM: This listener has stopped. Spawn a new message-listener agent to
continue listening.</span></span></code></pre>
</details>

<h2>Setup</h2>
<p>Copy both files into your project:</p>
<pre><code class="language-bash hljs"><span class="hljs-built_in">mkdir</span> -p .claude/agents
<span class="hljs-built_in">cp</span> docs/claude-agent-integration.md .  <span class="hljs-comment"># For reference</span>

<span class="hljs-comment"># Create the agent files (or copy from this doc)</span>
<span class="hljs-comment"># .claude/agents/thrum-agent.md</span>
<span class="hljs-comment"># .claude/agents/message-listener.md</span></code></pre>
<p>Or see the full agent definitions in the<br><a href="https://leonletto.github.io/thrum">documentation site</a>.</p>

    </div>
    <p style="margin-top:2rem"><a href="../docs.html#claude-agent-integration.html">&larr; View in documentation</a></p>
  </main>
  <script>
    // Redirect browsers to the SPA for full navigation experience.
    // Crawlers (which don't execute JS) will index the static content above.
    if (window.location.search.indexOf('nospa') === -1) {
      window.location.replace('../docs.html#claude-agent-integration.html');
    }
  </script>
</body>
</html>