<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Role-Based Preamble Templates — Thrum</title>
<meta name="description" content="Auto-generate agent preambles from role templates with scope boundaries, task protocol, communication patterns, and behavioral directives">
<link rel="canonical" href="https://leonletto.github.io/thrum/docs.html#role-templates.html">
<style>
body{font-family:system-ui,sans-serif;max-width:48rem;margin:2rem auto;padding:0 1.5rem;line-height:1.6;color:#222}
pre{background:#f5f5f5;padding:1rem;overflow-x:auto;border-radius:4px}
code{font-family:ui-monospace,monospace;font-size:0.9em}
table{border-collapse:collapse;width:100%}
th,td{border:1px solid #ddd;padding:0.4rem 0.6rem;text-align:left}
th{background:#f5f5f5}
nav{margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid #ddd;line-height:1.8}
h2{margin-top:2rem}
a{color:#0366d6}
</style>
</head>
<body>
<nav>
<strong><a href="../docs.html">Thrum Docs</a></strong> &rsaquo; uncategorized &rsaquo; Role-Based Preamble Templates
<hr>
<strong>Overview</strong>: <a href="philosophy.html">Philosophy</a><br>
<strong>Getting Started</strong>: <a href="quickstart.html">Quickstart Guide</a><br>
  <strong>Recommended Tools</strong>: <a href="guides/recommended-tools.html">Recommended Tools</a> | <a href="guides/beads-setup.html">Beads Setup Guide</a> | <a href="guides/beads-ui-setup.html">Beads UI Setup Guide</a> | <a href="guides/playwright-cli-setup.html">Playwright CLI Setup Guide</a><br>
<strong>Web UI</strong>: <a href="web-ui.html">Web UI</a><br>
<strong>Messaging</strong>: <a href="subscriptions.html">Subscriptions & Notifications</a><br>
<strong>Identity</strong>: <a href="identity.html">Agent Identity & Registration</a><br>
<strong>Guides</strong>: <a href="agent-coordination.html">Agent Coordination</a> | <a href="agent-configs.html">Agent Configurations</a> | <a href="multi-agent.html">Multi-Agent Support</a> | <a href="claude-code-plugin.html">Claude Code Plugin</a> | <a href="configuration.html">Configuration</a> | <a href="workflow-templates.html">Workflow Templates</a> | <a href="beads-and-thrum.html">Beads and Thrum</a> | <a href="codex-plugin.html">Codex Plugin</a> | <a href="claude-agent-integration.html">Claude Code Agent Integration</a> | <a href="messaging.html">Messaging</a> | <a href="tailscale-sync.html">Tailscale Sync</a> | <a href="tailscale-security.html">Tailscale Sync Security</a> | <a href="overview.html">Technical Overview</a><br>
<strong>API Reference</strong>: <a href="event-streaming.html">Event Streaming</a> | <a href="inbox-query-methods.html">Inbox Query Methods</a> | <a href="api/authentication.html">Authentication</a> | <a href="api/events.html">Event Reference</a> | <a href="rpc-api.html">RPC API</a> | <a href="api/websocket.html">WebSocket API</a><br>
<strong>Daemon</strong>: <a href="daemon.html">Daemon Architecture</a><br>
<strong>Sync</strong>: <a href="sync.html">Sync Protocol</a><br>
<strong>Development</strong>: <a href="development.html">Development Guide</a> | <a href="security-cicd.html">Security & CI/CD</a><br>
<strong>Architecture</strong>: <a href="architecture.html">Architecture</a><br>
<strong>Context</strong>: <a href="context.html">Agent Context Management</a><br>
<strong>Reference</strong>: <a href="cli.html">CLI Reference</a> | <a href="mcp-server.html">MCP Server</a><br>
<strong>uncategorized</strong>: <strong>Role-Based Preamble Templates</strong><br>
</nav>
<main>
<h2>Role-Based Preamble Templates</h2>
<h2>Overview</h2>
<p>Role templates automatically generate agent preambles during registration.
Instead of every agent getting the same default preamble, each role gets a
customized set of behavioral directives — scope boundaries, task protocol,
communication patterns, idle behavior, and efficiency rules.</p>
<p><strong>Three layers:</strong></p>
<ol>
<li><strong>Shipped examples</strong> in <code>toolkit/templates/roles/</code> — reference material with
strict and autonomous variants for each role</li>
<li><strong>Active templates</strong> in <code>.thrum/role_templates/</code> — per-project templates that
auto-apply on agent registration</li>
<li><strong>Claude skill</strong> (<code>thrum:configure-roles</code>) — interactive environment-aware
template generation</li>
</ol>
<h2>How It Works</h2>
<p>When an agent registers via <code>thrum quickstart --role implementer</code>, the system
checks for <code>.thrum/role_templates/implementer.md</code>. If found, it renders the
template with the agent&#39;s identity data and saves it as the agent&#39;s preamble.</p>
<p><strong>Precedence:</strong></p>
<ol>
<li><code>--preamble-file</code> flag (highest — explicit user choice)</li>
<li>Role template in <code>.thrum/role_templates/{role}.md</code></li>
<li>Default preamble (fallback)</li>
</ol>
<h2>Template Variables</h2>
<p>Templates use Go <code>text/template</code> syntax. Available variables:</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Source</th>
</tr>
</thead>
<tbody><tr>
<td><code>{{.AgentName}}</code></td>
<td>Agent identity (e.g., &quot;impl_auth&quot;)</td>
</tr>
<tr>
<td><code>{{.Role}}</code></td>
<td>Agent role (e.g., &quot;implementer&quot;)</td>
</tr>
<tr>
<td><code>{{.Module}}</code></td>
<td>Agent module (e.g., &quot;auth&quot;)</td>
</tr>
<tr>
<td><code>{{.WorktreePath}}</code></td>
<td>Resolved from identity file</td>
</tr>
<tr>
<td><code>{{.RepoRoot}}</code></td>
<td>Parent of .thrum/ directory</td>
</tr>
<tr>
<td><code>{{.CoordinatorName}}</code></td>
<td>First agent with role=coordinator, or &quot;coordinator&quot;</td>
</tr>
</tbody></table>
<h2>Template Structure</h2>
<p>Every role template follows the same section structure:</p>
<pre><code># Agent: {{.AgentName}}

**Role:** {{.Role}} **Module:** {{.Module}} **Worktree:** {{.WorktreePath}}

## Identity &amp; Authority

## Scope Boundaries

## Task Protocol

## Communication Protocol

## Message Listener

## Task Tracking

## Efficiency &amp; Context Management

## Idle Behavior

## Project-Specific Rules</code></pre>
<h2>Shipped Examples</h2>
<p>Reference templates in <code>toolkit/templates/roles/</code>:</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>coordinator-strict.md</code></td>
<td>All task assignment flows through coordinator</td>
</tr>
<tr>
<td><code>coordinator-autonomous.md</code></td>
<td>Coordinator orchestrates, agents can self-assign</td>
</tr>
<tr>
<td><code>implementer-strict.md</code></td>
<td>Waits for explicit task from coordinator</td>
</tr>
<tr>
<td><code>implementer-autonomous.md</code></td>
<td>Can pick up ready tasks from issue tracker</td>
</tr>
<tr>
<td><code>planner-strict.md</code></td>
<td>Read-only exploration, writes plans to docs</td>
</tr>
<tr>
<td><code>planner-autonomous.md</code></td>
<td>Can create issues and break down epics</td>
</tr>
<tr>
<td><code>researcher-strict.md</code></td>
<td>Read-only, responds to research requests</td>
</tr>
<tr>
<td><code>researcher-autonomous.md</code></td>
<td>Can proactively research when idle</td>
</tr>
</tbody></table>
<h2>CLI Commands</h2>
<h3>thrum roles list</h3>
<p>List configured templates and matching agents:</p>
<pre><code>thrum roles list
# coordinator.md    (2 agents: coord_main, coord_api)
# implementer.md    (3 agents: impl_auth, impl_payments, impl_ui)
# planner.md        (0 agents)</code></pre>
<h3>thrum roles deploy</h3>
<p>Re-render preambles for registered agents from role templates:</p>
<pre><code>thrum roles deploy              # Deploy for all agents
thrum roles deploy --agent foo  # Deploy for a specific agent
thrum roles deploy --dry-run    # Preview what would change</code></pre>
<p>Deploy is a full overwrite — templates are the source of truth.</p>
<h2>Setting Up</h2>
<h3>Manual setup</h3>
<ol>
<li>Copy a shipped example to <code>.thrum/role_templates/</code>:</li>
</ol>
<pre><code>cp toolkit/templates/roles/implementer-autonomous.md .thrum/role_templates/implementer.md</code></pre>
<ol>
<li><p>Edit to customize for your project.</p>
</li>
<li><p>Register agents — templates auto-apply:</p>
</li>
</ol>
<pre><code>thrum quickstart --name impl_auth --role implementer --module auth</code></pre>
<h3>Interactive setup (Claude Code)</h3>
<p>Run the configure-roles skill:</p>
<pre><code>/thrum:configure-roles</code></pre>
<p>The skill detects your environment (runtimes, worktrees, beads, MCP servers) and
generates customized templates interactively.</p>
<h2>File Layout</h2>
<pre><code>.thrum/
├── role_templates/           # Active templates (per-project)
│   ├── coordinator.md
│   ├── implementer.md
│   └── planner.md
├── context/
│   ├── impl_auth_preamble.md # Rendered output (per-agent)
│   └── coord_main_preamble.md
└── identities/
    ├── impl_auth.json
    └── coord_main.json</code></pre>

</main>
<script>if(location.search.indexOf('nospa')===-1){location.replace('../docs.html#role-templates.html')}</script>
</body>
</html>