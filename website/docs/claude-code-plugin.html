<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Claude Code Plugin — Thrum</title>
  <meta name="description" content="Install and use the Thrum plugin for Claude Code — slash commands, automatic context injection, and multi-agent coordination without manual configuration">
  <!-- Open Graph -->
  <meta property="og:type" content="article">
  <meta property="og:title" content="Claude Code Plugin — Thrum">
  <meta property="og:description" content="Install and use the Thrum plugin for Claude Code — slash commands, automatic context injection, and multi-agent coordination without manual configuration">
  <meta property="og:url" content="https://leonletto.github.io/thrum/docs/claude-code-plugin.html">
  <meta property="og:site_name" content="Thrum">
  <meta property="og:image" content="https://leonletto.github.io/thrum/img/social-card.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Claude Code Plugin — Thrum">
  <meta name="twitter:description" content="Install and use the Thrum plugin for Claude Code — slash commands, automatic context injection, and multi-agent coordination without manual configuration">
  <meta name="twitter:image" content="https://leonletto.github.io/thrum/img/social-card.png">
  <!-- Canonical: SPA is the primary URL -->
  <link rel="canonical" href="https://leonletto.github.io/thrum/docs.html#claude-code-plugin.html">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>&#x26A1;</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/theme.css">
  <link rel="stylesheet" href="../css/docs.css">
  <script>
    (function(){var t=localStorage.getItem('thrum-theme');if(t){document.documentElement.setAttribute('data-theme',t)}else if(window.matchMedia&&window.matchMedia('(prefers-color-scheme:light)').matches){document.documentElement.setAttribute('data-theme','light')}else{document.documentElement.setAttribute('data-theme','dark')}})();
  </script>
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <nav class="header-nav">
        <a href="../index.html" class="logo">
          <span class="logo-glyph">&gt;_</span>
          <span class="logo-text">thrum</span>
        </a>
        <div class="nav-links">
          <a href="../index.html" class="nav-link">Home</a>
          <a href="../docs.html" class="nav-link nav-link-active">Docs</a>
          <a href="../about.html" class="nav-link">About</a>
          <a href="https://github.com/leonletto/thrum" class="nav-link nav-link-external" target="_blank" rel="noopener">GitHub</a>
        </div>
      </nav>
    </div>
  </header>
  <main class="docs-content" style="max-width:48rem;margin:2rem auto;padding:0 1.5rem">
    <div class="docs-content-inner">
<h1>Claude Code Plugin</h1>
<blockquote>
<p>See also: <a href="quickstart.html">Quickstart Guide</a> for basic Thrum setup,<br><a href="agent-configs.html">Agent Configurations</a> for manual agent definitions,<br><a href="mcp-server.html">MCP Server</a> for the native MCP transport,<br><a href="multi-agent.html">Multi-Agent Support</a> for coordination patterns.</p>
</blockquote>
<h2>Overview</h2>
<p>The Thrum plugin for Claude Code gives agents native access to Thrum messaging<br>through slash commands, automatic context injection via hooks, and progressive<br>disclosure resource docs. It replaces the manual agent definition approach<br>(copying <code>.md</code> files into <code>.claude/agents/</code>) with a single plugin install.</p>
<p><strong>What you get:</strong></p>
<ul>
<li><strong>10 slash commands</strong> — <code>/thrum:send</code>, <code>/thrum:inbox</code>, <code>/thrum:quickstart</code>,<br>and more</li>
<li><strong>Automatic context</strong> — SessionStart and PreCompact hooks run <code>thrum prime</code> to<br>inject identity, team roster, inbox, and git state</li>
<li><strong>8 resource docs</strong> — Progressive disclosure for messaging patterns, groups,<br>identity, worktrees, and anti-patterns</li>
<li><strong>Background listener</strong> — Sub-agent template for async message monitoring</li>
</ul>
<h2>Prerequisites</h2>
<p>Before installing the plugin, you need Thrum installed and initialized:</p>
<pre><code class="language-bash hljs"><span class="hljs-comment"># Install thrum (Go 1.23+)</span>
go install github.com/leonletto/thrum@latest

<span class="hljs-comment"># Or build from source</span>
git <span class="hljs-built_in">clone</span> https://github.com/leonletto/thrum.git
<span class="hljs-built_in">cd</span> thrum &amp;&amp; make install

<span class="hljs-comment"># Initialize in your repository (v0.4.5+: init does full setup)</span>
<span class="hljs-built_in">cd</span> /path/to/your/repo
thrum init</code></pre>
<p><code>thrum init</code> (v0.4.5+) handles the full setup: prompts for runtime detection,<br>generates CLAUDE.md coordination instructions, starts the daemon, registers your<br>agent, and starts a session. For manual control, you can still run individual<br>steps:</p>
<pre><code class="language-bash hljs">thrum setup claude-md --apply    <span class="hljs-comment"># Generate CLAUDE.md coordination instructions</span>
thrum daemon start               <span class="hljs-comment"># Start the daemon separately</span></code></pre>
<p>Verify the daemon is running:</p>
<pre><code class="language-bash hljs">thrum daemon status</code></pre>
<h2>Installation</h2>
<h3>From GitHub (self-hosted marketplace)</h3>
<p>The plugin is distributed as a self-hosted marketplace. First add the<br>marketplace, then install the plugin:</p>
<pre><code class="language-bash hljs"><span class="hljs-comment"># Add the Thrum marketplace</span>
claude plugin marketplace add https://github.com/leonletto/thrum

<span class="hljs-comment"># Install the plugin</span>
claude plugin install thrum</code></pre>
<h3>From local clone</h3>
<p>If you&#39;ve cloned the Thrum repository locally:</p>
<pre><code class="language-bash hljs"><span class="hljs-comment"># Add as a local marketplace</span>
claude plugin marketplace add /path/to/thrum

<span class="hljs-comment"># Install the plugin</span>
claude plugin install thrum</code></pre>
<h3>Verify installation</h3>
<p>Start a new Claude Code session. The SessionStart hook should automatically run<br><code>thrum prime</code> and inject context. You&#39;ll see your agent identity, team roster,<br>and unread messages in the session preamble.</p>
<h2>Slash Commands</h2>
<p>All commands live under the <code>/thrum:</code> namespace.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>/thrum:quickstart</code></td>
<td>Register agent and start session (interactive or with flags)</td>
</tr>
<tr>
<td><code>/thrum:send</code></td>
<td>Send direct, group, or broadcast messages</td>
</tr>
<tr>
<td><code>/thrum:inbox</code></td>
<td>Check message inbox (all or unread only)</td>
</tr>
<tr>
<td><code>/thrum:reply</code></td>
<td>Reply to a message (inherits original audience)</td>
</tr>
<tr>
<td><code>/thrum:wait</code></td>
<td>Block until a message arrives (background listener use)</td>
</tr>
<tr>
<td><code>/thrum:team</code></td>
<td>Show active team members with roles and intents</td>
</tr>
<tr>
<td><code>/thrum:group</code></td>
<td>Create, manage, and message agent groups</td>
</tr>
<tr>
<td><code>/thrum:overview</code></td>
<td>Combined status + team + inbox view</td>
</tr>
<tr>
<td><code>/thrum:prime</code></td>
<td>Load full session context (identity, team, inbox, git)</td>
</tr>
<tr>
<td><code>/thrum:update-context</code></td>
<td>Guided workflow to save session narrative + state</td>
</tr>
</tbody></table>
<h3>Common workflows</h3>
<p><strong>Start a session:</strong></p>
<pre><code>/thrum:quickstart</code></pre>
<p>Prompts for role, module, and intent — or pass flags directly:</p>
<pre><code class="language-bash hljs">thrum quickstart --role implementer --module auth --intent <span class="hljs-string">&quot;Building login flow&quot;</span></code></pre>
<p><strong>Send a message:</strong></p>
<pre><code>/thrum:send</code></pre>
<p>Guided prompt for recipient and message. Direct usage:</p>
<pre><code class="language-bash hljs">thrum send <span class="hljs-string">&quot;Starting auth work&quot;</span> --to @coordinator
thrum send <span class="hljs-string">&quot;Need review&quot;</span> --to @reviewers
thrum send <span class="hljs-string">&quot;Heads up: breaking change&quot;</span> --to @everyone</code></pre>
<p><strong>Check inbox and reply:</strong></p>
<pre><code>/thrum:inbox
/thrum:reply</code></pre>
<h2>Hooks</h2>
<p>The plugin configures two hooks that run automatically:</p>
<h3>SessionStart</h3>
<p>Runs <code>thrum prime</code> when a Claude Code session begins. Injects:</p>
<ul>
<li>Agent identity (name, role, module)</li>
<li>Active team members and their intents</li>
<li>Unread messages</li>
<li>Git branch and status</li>
<li>Daemon health</li>
</ul>
<p>If Thrum isn&#39;t initialized, shows a friendly setup message instead of failing.</p>
<h3>PreCompact</h3>
<p>Runs <code>thrum prime</code> before context compaction. This ensures agent identity and<br>session state survive compaction — the agent can continue working without losing<br>track of who it is or what messages are pending.</p>
<h2>Resource Docs</h2>
<p>The plugin includes 8 resource documents that Claude loads on demand for deeper<br>guidance:</p>
<table>
<thead>
<tr>
<th>Resource</th>
<th>When it&#39;s used</th>
</tr>
</thead>
<tbody><tr>
<td><code>MESSAGING.md</code></td>
<td>Message lifecycle, addressing patterns</td>
</tr>
<tr>
<td><code>GROUPS.md</code></td>
<td>Creating groups, adding members, group messaging</td>
</tr>
<tr>
<td><code>IDENTITY.md</code></td>
<td>Agent naming, registration, multi-worktree identity</td>
</tr>
<tr>
<td><code>WORKTREES.md</code></td>
<td>Cross-worktree coordination, shared daemon, file tracking</td>
</tr>
<tr>
<td><code>LISTENER_PATTERN.md</code></td>
<td>Background message listener sub-agent template</td>
</tr>
<tr>
<td><code>BOUNDARIES.md</code></td>
<td>When to use Thrum vs TaskList/SendMessage</td>
</tr>
<tr>
<td><code>ANTI_PATTERNS.md</code></td>
<td>12 common mistakes and how to avoid them</td>
</tr>
<tr>
<td><code>CLI_REFERENCE.md</code></td>
<td>Complete command syntax for all <code>thrum</code> commands</td>
</tr>
</tbody></table>
<h2>MCP Server Integration</h2>
<p>For native tool-call integration (no shell-outs), configure the Thrum MCP server<br>in your project&#39;s <code>.claude/settings.json</code>:</p>
<pre><code class="language-json hljs"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;mcpServers&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;thrum&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;stdio&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;command&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;thrum&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;args&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;mcp&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;serve&quot;</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
<p>This provides 11 MCP tools: 5 for core messaging (<code>send_message</code>,<br><code>check_messages</code>, <code>wait_for_message</code>, <code>list_agents</code>, <code>broadcast_message</code>) and 6<br>for group management (<code>create_group</code>, <code>delete_group</code>, <code>add_group_member</code>,<br><code>remove_group_member</code>, <code>list_groups</code>, <code>get_group</code>). See<br><a href="mcp-server.html">MCP Server</a> for the full API.</p>
<p><strong>Plugin vs MCP:</strong> The plugin&#39;s slash commands use the CLI (<code>Bash(thrum:*)</code>).<br>The MCP server provides native tool calls. Both work — the plugin is simpler to<br>set up, the MCP server is more efficient for high-frequency messaging. You can<br>use both together.</p>
<h2>Background Listener</h2>
<p>When <code>thrum prime</code> runs in a Claude Code session and detects an active identity,<br>it outputs a ready-to-use listener spawn instruction with the correct repo path.<br>Copy and run it to start background message monitoring:</p>
<pre><code>Task(
  subagent_type=&quot;message-listener&quot;,
  model=&quot;haiku&quot;,
  run_in_background=true,
  prompt=&quot;Listen for Thrum messages.
    WAIT_CMD=cd /path/to/repo &amp;&amp; thrum wait --timeout 15m --after -30s --json&quot;
)</code></pre>
<p>The listener runs 6 cycles of 15 minutes each (~90 min coverage), blocks on<br><code>thrum wait</code> (no polling), returns when messages arrive, and costs<br>~$0.00003/cycle on Haiku. Re-arm after processing each batch. See the<br><code>LISTENER_PATTERN.md</code> resource for the full template.</p>
<h2>Plugin vs Manual Agent Definitions</h2>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Plugin</th>
<th>Manual (toolkit/agents/)</th>
</tr>
</thead>
<tbody><tr>
<td>Installation</td>
<td><code>claude plugin marketplace add</code> + <code>install</code></td>
<td>Copy <code>.md</code> files to <code>.claude/agents/</code></td>
</tr>
<tr>
<td>Updates</td>
<td>Re-install from source</td>
<td>Manual file replacement</td>
</tr>
<tr>
<td>Slash commands</td>
<td>10 commands included</td>
<td>None</td>
</tr>
<tr>
<td>Hooks</td>
<td>SessionStart + PreCompact</td>
<td>Manual hook configuration</td>
</tr>
<tr>
<td>Resource docs</td>
<td>8 progressive disclosure docs</td>
<td>Single monolithic agent file</td>
</tr>
<tr>
<td>Maintenance</td>
<td>Versioned (v0.4.5)</td>
<td>Ad-hoc</td>
</tr>
</tbody></table>
<p>The manual agent definitions (<code>thrum-agent.md</code>, <code>message-listener.md</code>) still<br>work and are available in <code>toolkit/agents/</code> for environments that don&#39;t support<br>plugins.</p>
<h2>Troubleshooting</h2>
<p><strong>&quot;Thrum not initialized&quot; on session start</strong></p>
<p>Run <code>thrum init &amp;&amp; thrum daemon start</code> in your repository root.</p>
<p><strong>No context injected after plugin install</strong></p>
<p>Verify the plugin is loaded: check that <code>/thrum:prime</code> is available as a slash<br>command. If not, reinstall the plugin.</p>
<p><strong>Messages not arriving</strong></p>
<p>Check daemon status with <code>thrum daemon status</code>. The daemon must be running for<br>messaging to work. Start it with <code>thrum daemon start</code>.</p>
<p><strong>Identity conflicts in multi-worktree setups</strong></p>
<p>Set <code>THRUM_NAME</code> environment variable to give each worktree a unique agent name.<br>See <a href="identity.html">Identity System</a> for details.</p>

    </div>
    <p style="margin-top:2rem"><a href="../docs.html#claude-code-plugin.html">&larr; View in documentation</a></p>
  </main>
  <script>
    // Redirect browsers to the SPA for full navigation experience.
    // Crawlers (which don't execute JS) will index the static content above.
    if (window.location.search.indexOf('nospa') === -1) {
      window.location.replace('../docs.html#claude-code-plugin.html');
    }
  </script>
</body>
</html>